require(dplyr)
require(RWeka)
require(arules)
require(arulesViz)
require(ggplot2)
bank <- read.csv("bankdata_csv_all.csv", stringsAsFactors = FALSE)
str(bank)
summary(bank)
ggplot(bank, aes(x=income, y=age)) +
geom_point(shape=18, color="blue")+
geom_smooth(method=lm, se=FALSE, linetype="dashed",
color="darkred")
ggplot(bank, aes(x=income, color=sex)) +
geom_histogram(fill="white")
bank <- select(bank, -c(1))
bank$age <- cut(bank$age, breaks = c(0,10,20,30,40,50,60,Inf),labels=c("children","teenagers","twenties","thirties","fourties","fifties","elderly"))
bank$income <- cut(bank$income, breaks = c(0,17264,24925,36173,Inf),labels=c("LowestIncome","LowIncome","HighIncome","HighestIncome"))
bank$married=dplyr::recode(bank$married, YES="married=YES", NO="married=NO")
bank$car=dplyr::recode(bank$car, YES="car=YES", NO="car=NO")
bank$save_act=dplyr::recode(bank$save_act, YES="save_act=YES", NO="save_act=NO")
bank$current_act=dplyr::recode(bank$current_act, YES="current_act=YES", NO="current_act=NO")
bank$mortgage=dplyr::recode(bank$mortgage, YES="mortgage=YES", NO="mortgage=NO")
bank$pep=dplyr::recode(bank$pep, YES="pep=YES", NO="pep=NO")
cols <- c("sex","region","married","children", "car",
"save_act","current_act","mortgage","pep")
bank[,cols] <- lapply(bank[,cols],as.factor)
options(scipen = 999)
options(digits=3)
str(bank)
rules <- apriori(bank, parameter = list(supp = 0.2, conf = 0.76))
summary(rules)
rules <- sort(rules, decreasing = TRUE, by = "lift")
plot(rules[1:5],method="graph")
inspect(rules[1:5])
View(bank)
View(bank)
